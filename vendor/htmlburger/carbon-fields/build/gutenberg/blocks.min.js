/*! For license information please see blocks.min.js.LICENSE.txt */
(()=>{var e={284:(e,t,n)=>{e.exports={forEach:n(458),fromObs:n(751),fromIter:n(258),fromEvent:n(550),fromPromise:n(571),interval:n(988),map:n(774),scan:n(72),flatten:n(515),take:n(967),skip:n(144),filter:n(996),merge:n(286),concat:n(796),combine:n(930),share:n(949),pipe:n(835)}},930:e=>{const t={};e.exports=(...e)=>(n,r)=>{if(0!==n)return;const o=e.length;if(0===o)return r(0,(()=>{})),r(1,[]),void r(2);let i=o,s=o,l=o;const a=new Array(o),c=new Array(o),d=(e,t)=>{if(0!==e)for(let n=0;n<o;n++)c[n](e,t)};e.forEach(((e,n)=>{a[n]=t,e(0,((e,p)=>{if(0===e)c[n]=p,0==--i&&r(0,d);else if(1===e){const e=s?a[n]===t?--s:s:0;if(a[n]=p,0===e){const e=new Array(o);for(let t=0;t<o;++t)e[t]=a[t];r(1,e)}}else 2===e?0==--l&&r(2):r(e,p)}))}))}},796:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const r={},o=(...e)=>(t,n)=>{if(0!==t)return;const o=e.length;if(0===o)return n(0,(()=>{})),void n(2);let i,s=0,l=r;const a=(e,t)=>{1===e&&(l=t),i(e,t)};!function t(){s!==o?e[s](0,((e,o)=>{0===e?(i=o,0===s?n(0,a):l!==r&&i(1,l)):2===e&&o?n(2,o):2===e?(s++,t()):n(e,o)})):n(2)}()}},996:e=>{e.exports=e=>t=>(n,r)=>{if(0!==n)return;let o;t(0,((t,n)=>{0===t?(o=n,r(t,n)):1===t?e(n)?r(t,n):o(1):r(t,n)}))}},515:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=e=>(t,n)=>{if(0!==t)return;let r,o;function i(e,t){1===e&&(o||r)(1,t),2===e&&(o&&o(2),r&&r(2))}e(0,((e,t)=>{if(0===e)r=t,n(0,i);else if(1===e){const e=t;o&&o(2),e(0,((e,t)=>{0===e?(o=t,o(1)):1===e?n(1,t):2===e&&t?(r&&r(2),n(2,t)):2===e&&(r?(o=void 0,r(1)):n(2))}))}else 2===e&&t?(o&&o(2),n(2,t)):2===e&&(o?r=void 0:n(2))}))}},458:e=>{e.exports=e=>t=>{let n;t(0,((t,r)=>{0===t&&(n=r),1===t&&e(r),1!==t&&0!==t||n(1)}))}},550:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=(e,t,n)=>(r,o)=>{if(0!==r)return;let i=!1;const s=e=>{o(1,e)};if(o(0,(r=>{if(2===r)if(i=!0,e.removeEventListener)e.removeEventListener(t,s,n);else{if(!e.removeListener)throw new Error("cannot remove listener from node. No method found.");e.removeListener(t,s)}})),!i)if(e.addEventListener)e.addEventListener(t,s,n);else{if(!e.addListener)throw new Error("cannot add listener to node. No method found.");e.addListener(t,s)}}},258:e=>{e.exports=e=>(t,n)=>{if(0!==t)return;const r="undefined"!=typeof Symbol&&e[Symbol.iterator]?e[Symbol.iterator]():e;let o,i=!1,s=!1,l=!1;n(0,(e=>{l||(1===e?(s=!0,i||o&&o.done||function(){for(i=!0;s&&!l;){if(s=!1,o=r.next(),o.done){n(2);break}n(1,o.value)}i=!1}()):2===e&&(l=!0))}))}},751:(e,t,n)=>{const r=n(121).Z;e.exports=e=>(t,n)=>{if(0!==t)return;let o;n(0,(e=>{2===e&&o&&(o.unsubscribe?o.unsubscribe():o())})),e=e[r]?e[r]():e,o=e.subscribe({next:e=>n(1,e),error:e=>n(2,e),complete:()=>n(2)})}},571:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=e=>(t,n)=>{if(0!==t)return;let r=!1;e.then((e=>{r||(n(1,e),r||n(2))}),((e=new Error)=>{r||n(2,e)})),n(0,(e=>{2===e&&(r=!0)}))}},988:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=e=>(t,n)=>{if(0!==t)return;let r=0;const o=setInterval((()=>{n(1,r++)}),e);n(0,(e=>{2===e&&clearInterval(o)}))}},774:e=>{e.exports=e=>t=>(n,r)=>{0===n&&t(0,((t,n)=>{r(t,1===t?e(n):n)}))}},286:e=>{e.exports=function(...e){return(t,n)=>{if(0!==t)return;const r=e.length,o=new Array(r);let i=0,s=0;const l=e=>{if(0!==e)for(let t=0;t<r;t++)o[t]&&o[t](e)};for(let t=0;t<r;t++)e[t](0,((e,a)=>{0===e?(o[t]=a,1==++i&&n(0,l)):2===e?(o[t]=void 0,++s===r&&n(2)):n(e,a)}))}}},835:e=>{e.exports=function(...e){let t=e[0];for(let n=1,r=e.length;n<r;n++)t=e[n](t);return t}},72:e=>{e.exports=function(e,t){let n=2===arguments.length;return r=>(o,i)=>{if(0!==o)return;let s=t;r(0,((t,r)=>{1===t?(s=n?e(s,r):(n=!0,r),i(1,s)):i(t,r)}))}}},949:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=e=>{let t,n=[];return function(r,o){if(0!==r)return;n.push(o);const i=(e,r)=>{if(2===e){const e=n.indexOf(o);e>-1&&n.splice(e,1),n.length||t(2)}else t(e,r)};1!==n.length?o(0,i):e(0,((e,r)=>{if(0===e)t=r,o(0,i);else for(let t of n.slice(0))t(e,r);2===e&&(n=[])}))}}},144:e=>{e.exports=e=>t=>(n,r)=>{if(0!==n)return;let o,i=0;t(0,((t,n)=>{0===t?(o=n,r(t,n)):1===t&&i<e?(i++,o(1)):r(t,n)}))}},967:e=>{e.exports=e=>t=>(n,r)=>{if(0!==n)return;let o,i,s=0;function l(t,n){2===t?(i=!0,o(t,n)):s<e&&o(t,n)}t(0,((t,n)=>{0===t?(o=n,r(0,l)):1===t?s<e&&(s++,r(t,n),s!==e||i||(i=!0,o(2),r(2))):r(t,n)}))}},184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var s=o.apply(null,n);s&&e.push(s)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var l in n)r.call(n,l)&&n[l]&&e.push(l)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},270:()=>{},207:()=>{},992:()=>{},172:()=>{},574:()=>{},221:()=>{},545:()=>{},998:()=>{},442:()=>{},790:()=>{},730:()=>{},1:()=>{},519:()=>{},455:()=>{},491:()=>{},604:()=>{},562:()=>{},160:()=>{},121:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r}),e=n.hmd(e);const r=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:e)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r](i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{setupContainerDefinitions:()=>C,setupFieldDefinitions:()=>G});var t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function i(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,{getContainerDefinitionByBlockName:()=>P,getFieldDefinitionsByBlockName:()=>T});const s=wp.data,l=wp.blocks,a=wp.i18n,c=lodash,d=wp.compose,p=wp.hooks,u=cf.core;var f=function(e,t){return e===t};const b=function(e){return void 0===e&&(e=f),function(t){return function(n,r){if(0===n){var o,i,s=!1;t(0,(function(t,n){0===t&&(i=n),1===t?s&&e(o,n)?i(1):(s=!0,o=n,r(1,n)):r(t,n)}))}}}};var h=n(284);function m(e,t=0){return(0,c.mapKeys)(e,((e,n)=>`${(0,c.repeat)("parent.",t)}${n}`))}function g(e){return(0,c.startsWith)(e,"cf-")}const y=(0,u.withConditionalLogic)((function(e){return(0,h.pipe)((0,u.fromSelector)((0,s.select)("core/block-editor").getBlock,e.blockId),b(),(0,h.map)((e=>e?.attributes?.data)))}),(function(e,t){let n={};if((0,c.has)(t,e.field.base_name))n=m((0,c.omit)(t,[e.field.base_name]));else{const r=e.id.split("__");r.shift();const o=r.shift();r.pop();let i=r.reduce(((e,t)=>g(t)?e:e+1),0);n=(0,c.omit)(t,[o]),n=m(n,i+1);let s=o;for(;r.length>0;){const o=r.shift(),l=g(o),a=!l;if(l){s=`${s}.${(0,c.findIndex)((0,c.get)(t,s),["_id",o])}`;let r=(0,c.get)(t,s);r=(0,c.omit)(r,["_id","_type",e.field.base_name]),r=m(r,i),(0,c.assign)(n,r)}a&&(s=`${s}.${o}`,i--)}}return n}));n(992);(0,p.addFilter)("carbon-fields.association.block","carbon-fields/blocks",(0,u.withProps)((e=>({hierarchyResolver(){const t=(0,s.select)("core/block-editor").getBlock(e.blockId),n=e.id.split("__");n.shift();let r=n.shift(),o=`data.${r}`;for(;n.length>0;){const e=n.shift();if(0===e.indexOf("cf-")){const n=(0,c.get)(t.attributes,`${o}`),i=(0,c.find)(n,["_id",e]),s=n.indexOf(i);o=`${o}.${s}`,r=`${r}[${s}]:${i._type}/`}else o=`${o}.${e}`,r=`${r}${e}`}return r}}))));const w=cf.vendor.immer;var v=n.n(w);const _=wp.element;n(574),n(207);const k=(0,u.withFilters)("carbon-fields.field-wrapper.block")(u.Field);class E extends _.Component{constructor(...e){super(...e),i(this,"state",{collapsedGroups:this.props.value.reduce(((e,{_id:t,_type:n})=>(0,c.find)(this.props.field.groups,["name",n]).collapsed?e.concat(t):e),[])}),i(this,"handleAddGroup",((e,t)=>{const{id:n,value:r,onChange:o}=this.props,i={};i._id=(0,u.uniqueId)(),i._type=e.name,e.fields.reduce(((e,t)=>(e[t.base_name]=t.default_value,e)),i),o(n,r.concat(i)),t(i)})),i(this,"handleCloneGroup",((e,t)=>{const{id:n,value:r,onChange:o}=this.props,i=r.indexOf(e),s=(0,c.cloneDeep)(e);s._id=(0,u.uniqueId)(),o(n,v()(r,(e=>{e.splice(i+1,0,s)}))),t(s)})),i(this,"handleRemoveGroup",(e=>{const{id:t,value:n,onChange:r}=this.props,o=(0,c.findIndex)(n,["_id",e._id]);r(t,v()(n,(e=>{e.splice(o,1)}))),this.setState((({collapsedGroups:t})=>({collapsedGroups:(0,c.without)(t,e._id)})))})),i(this,"handleToggleGroup",(e=>{this.setState((({collapsedGroups:t})=>({collapsedGroups:t=t.indexOf(e)>-1?(0,c.without)(t,e):[...t,e]})))})),i(this,"handleToggleAllGroups",(()=>{const{value:e}=this.props;this.setState((({collapsedGroups:t})=>({collapsedGroups:t=t.length!==e.length?e.map((e=>e._id)):[]})))})),i(this,"handleGroupSetup",((e,t)=>{const n=(0,c.get)((0,c.find)(this.props.field.groups,["name",e._type]),"fields",[]),r=(0,c.omit)(e,["_id","_type"]);return(0,c.assign)({},t,{id:e._id,fields:n,collapsed:this.state.collapsedGroups.indexOf(e._id)>-1,context:"block",values:r})})),i(this,"handleGroupFieldSetup",((e,t,n)=>{const{blockId:r}=this.props,o=`${this.props.id}__${n.id}__${e.base_name}`,i=(0,c.get)(n,`values.${e.base_name}`);return[k,(0,c.assign)({},t,{key:o,id:o,name:e.base_name,containerId:this.props.containerId,blockId:r,field:e,value:i,onChange:this.handleGroupFieldChange})]})),i(this,"handleGroupFieldChange",((e,t)=>{const{id:n,value:r,onChange:o}=this.props;o(n,v()(r,(n=>{const r=e.split("__"),o=r.pop(),i=(0,c.find)(n,["_id",r.pop()]);(0,c.set)(i,o,t)})))}))}getGroupValues(){return this.props.value.map((e=>{const t=(0,c.mapKeys)((0,c.omit)(e,["_id","_type"]),((e,t)=>t.replace(/\-/g,"_")));return[e._type,t]}))}render(){const{handleGroupSetup:e,handleGroupFieldSetup:t,handleAddGroup:n,handleCloneGroup:r,handleRemoveGroup:o,handleToggleGroup:i,handleToggleAllGroups:s}=this,{value:l,children:a}=this.props;return a({groupValues:this.getGroupValues(),allGroupsAreCollapsed:this.state.collapsedGroups.length===l.length,handleGroupSetup:e,handleGroupFieldSetup:t,handleAddGroup:n,handleCloneGroup:r,handleRemoveGroup:o,handleToggleGroup:i,handleToggleAllGroups:s})}}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O.apply(this,arguments)}(0,p.addFilter)("carbon-fields.complex.block","carbon-fields/blocks",(e=>t=>{const{id:n,name:r,value:o,error:i,field:s}=t;return wp.element.createElement(E,t,(({groupValues:l,allGroupsAreCollapsed:a,handleGroupSetup:c,handleGroupFieldSetup:d,handleAddGroup:p,handleCloneGroup:u,handleRemoveGroup:f,handleToggleGroup:b,handleToggleAllGroups:h})=>wp.element.createElement(e,{groupIdKey:"_id",groupFilterKey:"_type",id:n,name:r,value:o,error:i,field:s,groupValues:l,allGroupsAreCollapsed:a,onGroupSetup:c,onGroupFieldSetup:d,onAddGroup:p,onCloneGroup:u,onRemoveGroup:f,onToggleGroup:b,onToggleAllGroups:h,onChange:t.onChange})))}));const S=wp.date;n(221);class F extends _.Component{constructor(...e){super(...e),i(this,"handleChange",((e,t)=>{const{id:n,onChange:r,value:o,field:i}=this.props,s=(0,S.format)(i.storage_format,t);s!==o&&r(n,s)}))}render(){const{handleChange:e}=this,{children:t}=this.props;return t({handleChange:e})}}(0,p.addFilter)("carbon-fields.date_time.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(F,t,(({handleChange:n})=>wp.element.createElement(e,O({buttonText:(0,a.__)("Select Date","carbon-fields-ui")},t,{onChange:n})))))),(0,p.addFilter)("carbon-fields.date.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(F,t,(({handleChange:n})=>wp.element.createElement(e,O({},t,{onChange:n})))))),(0,p.addFilter)("carbon-fields.time.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(F,t,(({handleChange:n})=>wp.element.createElement(e,O({},t,{onChange:n}))))));n(545);(0,p.addFilter)("carbon-fields.file.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(e,O({buttonLabel:(0,a.__)("Select File","carbon-fields-ui"),mediaLibraryButtonLabel:(0,a.__)("Use File","carbon-fields-ui"),mediaLibraryTitle:(0,a.__)("Select File","carbon-fields-ui")},t))));const I=({type:e})=>wp.element.createElement("em",null,(0,a.sprintf)((0,a.__)("Field of type '%s' is not supported in Gutenberg.","carbon-fields-ui"),[e]));(0,p.addFilter)("carbon-fields.footer_scripts.block","carbon-fields/blocks",(()=>e=>wp.element.createElement(I,{type:e.field.type}))),(0,p.addFilter)("carbon-fields.header_scripts.block","carbon-fields/blocks",(()=>e=>wp.element.createElement(I,{type:e.field.type}))),(0,p.addFilter)("carbon-fields.hidden.block","carbon-fields/blocks",(()=>e=>wp.element.createElement(I,{type:e.field.type}))),(0,p.addFilter)("carbon-fields.image.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(e,O({buttonLabel:(0,a.__)("Select Image","carbon-fields-ui"),mediaLibraryButtonLabel:(0,a.__)("Use Image","carbon-fields-ui"),mediaLibraryTitle:(0,a.__)("Select Image","carbon-fields-ui")},t))));n(998),n(790),n(442);(0,p.addFilter)("carbon-fields.media_gallery.block","carbon-fields/blocks",(e=>t=>wp.element.createElement(e,O({buttonLabel:(0,a.__)("Select Attachments","carbon-fields-ui"),mediaLibraryButtonLabel:(0,a.__)("Use Attachments","carbon-fields-ui"),mediaLibraryTitle:(0,a.__)("Select Attachments","carbon-fields-ui")},t))));n(730),n(519),n(1),n(455),n(604);(0,p.addFilter)("carbon-fields.sidebar.block","carbon-fields/blocks",(()=>e=>wp.element.createElement(I,{type:e.field.type})));n(491),n(562),n(160),n(172);(0,p.addFilter)("carbon-fields.field-edit.block","carbon-fields/blocks",(0,d.compose)(y,(0,s.withDispatch)((e=>{if(!(0,c.isUndefined)(window._wpLoadBlockEditor)){const{lockPostSaving:t,unlockPostSaving:n}=e("core/editor");return{lockSaving:t,unlockSaving:n}}return{}})),u.withValidation));const j=(0,s.combineReducers)({containerDefinitionsByBlockName:function(e={},t){return"SETUP_CONTAINER_DEFINITIONS"===t.type?t.payload.definitions:e},fieldDefinitionsByBlockName:function(e={},t){return"SETUP_FIELD_DEFINITIONS"===t.type?t.payload.definitions:e}});function C(e){return{type:"SETUP_CONTAINER_DEFINITIONS",payload:{definitions:e}}}function G(e){return{type:"SETUP_FIELD_DEFINITIONS",payload:{definitions:e}}}function P(e,t){return e.containerDefinitionsByBlockName[t.replace("carbon-fields/","")]||{}}function T(e,t){return e.fieldDefinitionsByBlockName[t.replace("carbon-fields/","")]||[]}(0,s.registerStore)("carbon-fields/blocks",{reducer:j,actions:e,selectors:t});var x=n(184),N=n.n(x);const B=wp.components,D=wp.editor;n(270);const $=wp.apiFetch;var L=n.n($);class M extends _.Component{constructor(...e){super(...e),i(this,"state",{response:null})}componentDidMount(){this.isStillMounted=!0,this.fetch(this.props),this.fetch=(0,c.debounce)(this.fetch,500)}componentWillUnmount(){this.isStillMounted=!1}componentDidUpdate(e){(0,c.isEqual)(e,this.props)||this.fetch(this.props)}fetch(e){if(!this.isStillMounted)return;null!==this.state.response&&this.setState({response:null});const{block:t}=e,n=this.currentFetchRequest=L()({method:"post",path:"/carbon-fields/v1/block-renderer",data:{name:t.name,content:(0,l.serialize)([t])}}).then((e=>{this.isStillMounted&&n===this.currentFetchRequest&&e&&e.rendered&&this.setState({response:e.rendered})})).catch((e=>{this.isStillMounted&&n===this.currentFetchRequest&&this.setState({response:{error:!0,errorMsg:e.message}})}))}render(){const{response:e}=this.state,{className:t}=this.props;return e?e.error?wp.element.createElement(B.Placeholder,{className:t},(0,a.sprintf)((0,a.__)("Error loading block: %s","carbon-fields-ui"),e.errorMsg)):e.length?wp.element.createElement(_.RawHTML,{key:"html",className:t},e):wp.element.createElement(B.Placeholder,{className:t},(0,a.__)("No results found.","carbon-fields-ui")):wp.element.createElement(B.Placeholder,{className:t},wp.element.createElement(B.Spinner,null))}}const A=(0,s.withSelect)(((e,{clientId:t})=>{const{getBlock:n}=e("core/block-editor");return{block:n(t)}}))(M);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class q extends _.Component{constructor(...e){super(...e),i(this,"state",{mode:this.props.container.settings.mode,currentTab:this.props.supportsTabs?Object.keys(this.props.container.settings.tabs)[0]:null}),i(this,"handleFieldChange",((e,t)=>{const{attributes:n,setAttributes:r}=this.props,o=e.replace(/^.+__(.+)?$/,"$1");r({data:U(U({},n.data),{},{[o]:t})})})),i(this,"handleModeChange",(()=>{this.setState({mode:this.isInEditMode?"preview":"edit"})})),i(this,"handleTabChange",(e=>{this.setState({currentTab:e})})),i(this,"renderField",((e,t)=>{const{clientId:n,container:r,attributes:o}=this.props,i=(0,u.getFieldType)(e.type,"block");if(!i)return null;const s=`cf-${n}__${e.base_name}`,l=(0,c.get)(o.data,e.base_name,e.default_value);return wp.element.createElement(k,{key:t,id:s,field:e},wp.element.createElement(i,{id:s,containerId:r.id,blockId:n,value:l,field:e,name:e.base_name,onChange:this.handleFieldChange}))}))}get isInEditMode(){return"edit"===this.state.mode}get isInPreviewMode(){return"preview"===this.state.mode}renderTabbedFields(e){const{fields:t}=this.props;return(0,c.map)(e,((e,n)=>{const r=(0,c.find)(t,["name",e]);return this.renderField(r,n)}))}renderNonTabbedFields(){return wp.element.createElement("div",{className:"cf-block__fields"},this.props.fields.map(this.renderField))}render(){const{currentTab:e}=this.state,{clientId:t,container:n,supportsTabs:r,supportsPreview:o,supportsInnerBlocks:i}=this.props,s=i&&this.isInEditMode&&wp.element.createElement("div",{className:"cf-block__inner-blocks"},wp.element.createElement(D.InnerBlocks,{template:n.settings.inner_blocks.template,templateLock:n.settings.inner_blocks.template_lock,allowedBlocks:n.settings.inner_blocks.allowed_blocks}));return wp.element.createElement(_.Fragment,null,"above"===n.settings.inner_blocks.position&&s,o&&wp.element.createElement(D.BlockControls,null,wp.element.createElement(B.ToolbarGroup,{label:"Options",controls:[{icon:this.isInEditMode?"visibility":"hidden",title:this.isInEditMode?(0,a.__)("Show preview","carbon-fields-ui"):(0,a.__)("Hide preview","carbon-fields-ui"),onClick:this.handleModeChange}]})),this.isInEditMode&&r&&wp.element.createElement("div",{className:"cf-block__tabs"},wp.element.createElement("ul",{className:"cf-block__tabs-list"},(0,c.map)(n.settings.tabs,((t,n)=>{const r=N()("cf-block__tabs-item",{"cf-block__tabs-item--current":n===e});return wp.element.createElement("li",{key:n,className:r,onClick:()=>this.handleTabChange(n)},n)})))),this.isInEditMode&&(r?(0,c.map)(n.settings.tabs,((t,n)=>wp.element.createElement("div",{className:"cf-block__fields",key:n,hidden:n!==e},this.renderTabbedFields(t)))):this.renderNonTabbedFields()),this.isInPreviewMode&&wp.element.createElement("div",{className:"cf-block__preview"},wp.element.createElement(A,{clientId:t})),"below"===n.settings.inner_blocks.position&&s,this.isInPreviewMode&&wp.element.createElement(D.InspectorControls,null,r?(0,c.map)(n.settings.tabs,((e,t)=>wp.element.createElement(B.PanelBody,{key:t,title:t},wp.element.createElement("div",{className:"cf-block__fields"},this.renderTabbedFields(e))))):wp.element.createElement(B.PanelBody,{title:(0,a.__)("Fields","carbon-fields-ui")},this.renderNonTabbedFields())))}}const V=(0,s.withSelect)(((e,{clientId:t,name:n})=>{const{hasBlockSupport:r}=e("core/blocks"),{getBlockRootClientId:o}=e("core/block-editor"),{getContainerDefinitionByBlockName:i,getFieldDefinitionsByBlockName:s}=e("carbon-fields/blocks"),l=o(t);return{container:i(n),fields:s(n),supportsTabs:r(n,"tabs"),supportsPreview:r(n,"preview")&&!l,supportsInnerBlocks:r(n,"innerBlocks")}}))(q);class K extends _.Component{render(){return null}}wp.hooks.addFilter("blocks.getSaveElement","carbon-fields/blocks",(function(e,t){return/^carbon\-fields\/.+$/.test(t.name)&&t.supports.innerBlocks?wp.element.createElement(D.InnerBlocks.Content,null):e}));const W=K;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(0,a.setLocaleData)(window.cf.config.locale,"carbon-fields-ui");const J={},Q={};(0,c.get)(window.cf,"preloaded.blocks",[]).forEach((e=>{const t=(0,c.kebabCase)(e.id).replace("carbon-fields-container-",""),n=function(e){return e.reduce(((e,t)=>Z(Z({},e),{},{[t.base_name]:t.default_value})),{})}(e.fields),r=(t,n=void 0)=>(0,c.get)(e,`settings.${t}`,n)||n;J[t]=e,Q[t]=e.fields.map((e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))),(0,l.registerBlockType)(`carbon-fields/${t}`,{title:e.title,icon:r("icon"),parent:r("parent"),category:r("category.slug"),keywords:r("keywords",[]),description:r("description",""),attributes:{data:{type:"object",default:n}},supports:{tabs:(0,c.isPlainObject)(r("tabs")),preview:r("preview"),innerBlocks:r("inner_blocks.enabled"),alignWide:!1,anchor:!1,html:!1},edit:V,save:W,example:!0})})),(0,s.dispatch)("carbon-fields/blocks").setupContainerDefinitions(J),(0,s.dispatch)("carbon-fields/blocks").setupFieldDefinitions(Q)})()})();